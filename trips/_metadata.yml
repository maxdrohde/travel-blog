# Shared metadata for all trip posts
toc: false
resources:
  - "photo-locations.json"
include-before-body:
  text: |
    <div class="back-arrow-wrapper">
    <a href="/" class="back-arrow">‚Üê Back</a>
    </div>
include-in-header:
  text: |
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js"></script>
include-after-body:
  text: |
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      var el = document.querySelector(".trip-map");
      if (!el || typeof L === "undefined") return;
      var lat = parseFloat(el.dataset.lat);
      var lng = parseFloat(el.dataset.lng);
      var zoom = parseInt(el.dataset.zoom) || 5;
      var label = el.dataset.label || "";
      var TILE_URL = "https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png";
      var TILE_OPTS = { subdomains: "abcd", maxZoom: 19 };
      function isDark() { return document.body.classList.contains("quarto-dark"); }
      var map = L.map(el, {
        center: [lat, lng], zoom: zoom,
        zoomControl: false, attributionControl: false,
        dragging: false, scrollWheelZoom: false,
        doubleClickZoom: false, touchZoom: false,
        boxZoom: false, keyboard: false
      });
      var tileLayer = L.tileLayer(TILE_URL, TILE_OPTS).addTo(map);
      var marker = L.circleMarker([lat, lng], {
        radius: 7, fillColor: isDark() ? "#d4845a" : "#c4653a",
        color: "#fff", weight: 2, fillOpacity: 0.9
      }).addTo(map);
      if (label) {
        L.tooltip({
          permanent: true, direction: "right",
          offset: [12, 0], className: "trip-map-label"
        }).setLatLng([lat, lng]).setContent(label).addTo(map);
      }
      var wasDark = isDark();
      new MutationObserver(function() {
        var dark = isDark();
        if (dark === wasDark) return;
        wasDark = dark;
        marker.setStyle({ fillColor: dark ? "#d4845a" : "#c4653a" });
      }).observe(document.body, { attributes: true, attributeFilter: ["class"] });
    });
    // Leaflet maps need a resize when revealed in a hidden tab
    document.addEventListener("shown.bs.tab", function() {
      window.dispatchEvent(new Event("resize"));
    });
    </script>
